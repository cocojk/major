library(e1071)
library(rpart)
## install.packages("mlbench")
data(Glass, package="mlbench")

## split data into a train and test set
index <- 1:nrow(Glass)
testindex <- sample(index, trunc(length(index)/3))
testset <- Glass[testindex,]
trainset <- Glass[-testindex,]


## svm
svm.model <- svm(Type ~ ., data = trainset, cost = 10, gamma = 1)
svm.pred <- predict(svm.model, testset[,-10])


## rpart
rpart.model <- rpart(Type ~ ., data = trainset)
rpart.pred <- predict(rpart.model, testset[,-10], type = "class")

## compute svm confusion matrix
restult_svm <- table(pred = svm.pred, true = testset[,10])
acc_svm <- sum( diag(restult_svm) )/sum( restult_svm )

restult_ctree <- table(pred = rpart.pred, true = testset[,10])
acc_ctree <- sum( diag(restult_ctree) )/sum( restult_ctree )
cat( c('Accuracy of SVMs ', acc_svm , '\n'))

cat( c('Accuracy of CTrees ', acc_ctree, '\n'))

